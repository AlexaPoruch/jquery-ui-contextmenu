/*! jQuery context menu plugin - v0.1.0 - 2013-04-13 |  https://github.com/mar10/contextmenu |  Copyright (c) 2013 Martin Wendt; Licensed MIT */
(function(t){t.widget("ui.contextmenu",{version:"0.1.0",options:{delegate:"[data-menu]",ignoreParentSelect:!0,menu:null,taphold:800,beforeOpen:t.noop,blur:t.noop,close:t.noop,create:t.noop,focus:t.noop,init:t.noop,open:t.noop,select:t.noop},_create:function(){this.element.delegate(this.options.delegate,"contextmenu.contextmenu",t.proxy(this._openMenu,this)),this._trigger("init")},_getMenu:function(){var e=this.options.menu;return t.isFunction(e)&&(e=e()),"string"==typeof e?t(e):e},_getMenuWidget:function(){var t=this._getMenu();return t.data("ui-menu")||t.data("menu")},_openMenu:function(e){var n=this,o=this._getMenu(),i=e,u=i.target?i.target:i;return e.preventDefault(),e.relatedTarget=i.target,this._trigger("beforeOpen",e)===!1?!1:(o.hide().addClass("ui-contextmenu").menu({blur:t.proxy(this.options.blur,this),create:t.proxy(this.options.create,this),focus:t.proxy(this.options.focus,this),select:function(t,e){t.relatedTarget=i.target;var o=e.item.has(">a[aria-haspopup='true']").length>0;o&&n.options.ignoreParentSelect||(n._trigger.call(n,"select",t,e)!==!1&&n._closeMenu.call(n),t.preventDefault())}}),t(document).bind("keydown.contextmenu",function(e){e.which===t.ui.keyCode.ESCAPE&&n._closeMenu()}).bind("mousedown.contextmenu touchstart.contextmenu",function(e){t(e.target).closest(".ui-menu-item").length||n._closeMenu()}),o.show().css({position:"absolute",left:0,top:0}).position({my:"left top",at:"left bottom",of:u,collision:"fit"}).hide().slideDown("fast",function(){n._trigger.call(n,"open",e)}),void 0)},_closeMenu:function(){var t=this,e=this._getMenu();this.tapTimer&&(clearTimeout(this.tapTimer),this.tapTimer=null),e.fadeOut(function(){t._trigger("close")})},_setOption:function(){t.Widget.prototype._setOption.apply(this,arguments)},open:function(t){var e=jQuery.Event("contextmenu",{target:t.get(0)});return this.element.trigger(e)},close:function(){return this._closeMenu.call(this)}})})(jQuery);