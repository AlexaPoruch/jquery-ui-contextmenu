/*! jQuery context menu plugin - v0.1.0 - 2013-05-10 |  https://github.com/mar10/jquery-ui-contextmenu |  Copyright (c) 2013 Martin Wendt; Licensed MIT */
(function(e){e.widget("ui.contextmenu",{version:"0.2.0",options:{delegate:"[data-menu]",ignoreParentSelect:!0,menu:null,taphold:800,beforeOpen:e.noop,blur:e.noop,close:e.noop,create:e.noop,focus:e.noop,init:e.noop,open:e.noop,select:e.noop},_create:function(){var t=this.options;e.isArray(t.menu)&&(this.orgMenu=t.menu,t.menu=e.ui.contextmenu.createMenuMarkup(t.menu)),this.element.delegate(this.options.delegate,"contextmenu.contextmenu",e.proxy(this._openMenu,this)),this._trigger("init")},_destroy:function(){this.orgMenu&&(this.options.menu.remove(),this.options.menu=this.orgMenu)},_setOption:function(){e.Widget.prototype._setOption.apply(this,arguments)},_getMenu:function(){var t=this.options.menu;return e.isFunction(t)&&(t=t()),"string"==typeof t?e(t):t},_getMenuWidget:function(){var e=this._getMenu();return e.data("ui-menu")||e.data("menu")},_openMenu:function(t){var n=this,o=this._getMenu(),i=t,u=i.target?i.target:i;return t.preventDefault(),t.relatedTarget=i.target,this._trigger("beforeOpen",t)===!1?!1:(o.hide().addClass("ui-contextmenu").menu({blur:e.proxy(this.options.blur,this),create:e.proxy(this.options.create,this),focus:e.proxy(this.options.focus,this),select:function(e,t){e.relatedTarget=i.target;var o=t.item.has(">a[aria-haspopup='true']").length>0;o&&n.options.ignoreParentSelect||(n._trigger.call(n,"select",e,t)!==!1&&n._closeMenu.call(n),e.preventDefault())}}),e(document).bind("keydown.contextmenu",function(t){t.which===e.ui.keyCode.ESCAPE&&n._closeMenu()}).bind("mousedown.contextmenu touchstart.contextmenu",function(t){e(t.target).closest(".ui-menu-item").length||n._closeMenu()}),o.show().css({position:"absolute",left:0,top:0}).position({my:"left top",at:"left bottom",of:u,collision:"fit"}).hide().slideDown("fast",function(){n._trigger.call(n,"open",t)}),void 0)},_closeMenu:function(){var e=this,t=this._getMenu();this.tapTimer&&(clearTimeout(this.tapTimer),this.tapTimer=null),t.fadeOut(function(){e._trigger("close")})},open:function(e){var t=jQuery.Event("contextmenu",{target:e.get(0)});return this.element.trigger(t)},close:function(){return this._closeMenu.call(this)}}),e.extend(e.ui.contextmenu,{createMenuMarkup:function(t,n){var o,i,u,r,s;for(null==n&&(n=e("<ul class='ui-helper-hidden'>").appendTo("body")),o=0;t.length>o;o++)i=t[o],r=e("<li>").appendTo(n),i.title.match(/^---/)?r.text(i.title):(s=e("<a>",{text:""+i.title,href:"#"+(i.cmd||"")}).appendTo(r),i.uiIcon&&s.append(e("<span class='ui-icon'>").addClass(i.uiIcon)),i.disabled&&s.addClass("ui-state-disabled")),e.isArray(i.children)&&(u=e("<ul>").appendTo(r),e.ui.contextmenu.createMenuMarkup(i.children,u));return n}})})(jQuery);