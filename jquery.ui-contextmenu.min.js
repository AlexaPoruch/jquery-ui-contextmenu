/*! jQuery UI context menu plugin - v0.2.0 - 2013-05-16 |  https://github.com/mar10/jquery-ui-contextmenu |  Copyright (c) 2013 Martin Wendt; Licensed MIT */
(function(e){var t=".contextmenu",n="onselectstart"in document.createElement("div");e.widget("ui.contextmenu",{version:"0.3.0",options:{delegate:"[data-menu]",ignoreParentSelect:!0,menu:null,preventSelect:!1,taphold:!1,beforeOpen:e.noop,blur:e.noop,close:e.noop,create:e.noop,focus:e.noop,init:e.noop,open:e.noop,select:e.noop},_create:function(){var o=this.options,i="contextmenu"+t,s=this.element.uniqueId().attr("id");this.$headStyle=null,this.orgMenu=null,this.currentTarget=null,o.taphold&&(i+=" taphold"+t),o.preventSelect&&(this.$headStyle=e("<style>").prop("type","text/css").html("#"+s+" "+o.delegate+" { "+"-webkit-user-select: none; "+"-khtml-user-select: none; "+"-moz-user-select: none; "+"-ms-user-select: none; "+"user-select: none; "+"}").appendTo("head"),n&&this.element.delegate(o.delegate,"selectstart"+t,function(e){e.preventDefault()})),e.isArray(o.menu)&&(this.orgMenu=o.menu,o.menu=e.ui.contextmenu.createMenuMarkup(o.menu)),this._getMenu().hide().addClass("ui-contextmenu").menu({blur:e.proxy(this.options.blur,this),create:e.proxy(this.options.create,this),focus:e.proxy(this.options.focus,this),select:e.proxy(function(e,t){e.relatedTarget=this.currentTarget;var n=t.item.has(">a[aria-haspopup='true']").length>0;n&&this.options.ignoreParentSelect||(this._trigger.call(this,"select",e,t)!==!1&&this._closeMenu.call(this),e.preventDefault())},this)}),this.element.delegate(o.delegate,i,e.proxy(this._openMenu,this)),this._trigger("init")},_destroy:function(){this.$headStyle&&(this.$headStyle.remove(),this.$headStyle=null),this.orgMenu&&(this.options.menu.remove(),this.options.menu=this.orgMenu,this.orgMenu=null)},_setOption:function(){e.Widget.prototype._setOption.apply(this,arguments)},_getMenu:function(){var t=this.options.menu;return e.isFunction(t)&&(t=t()),"string"==typeof t?e(t):t},_openMenu:function(n){var o=this,i=this._getMenu(),s=n,u=s.target?s.target:s;return this.currentTarget=s.target,n.preventDefault(),n.relatedTarget=this.currentTarget,this._trigger("beforeOpen",n)===!1?!1:(e(document).bind("keydown"+t,function(t){t.which===e.ui.keyCode.ESCAPE&&o._closeMenu()}).bind("mousedown"+t+" touchstart"+t,function(t){e(t.target).closest(".ui-menu-item").length||o._closeMenu()}),i.show().css({position:"absolute",left:0,top:0}).position({my:"left top",at:"left bottom",of:u,collision:"fit"}).hide().slideDown("fast",function(){o._trigger.call(o,"open",n)}),void 0)},_closeMenu:function(){var n=this,o=this._getMenu();o.fadeOut(function(){n._trigger("close"),this.currentTarget=null}),e(document).unbind("mousedown"+t).unbind("touchstart"+t).unbind("keydown"+t)},open:function(e){var t=jQuery.Event("contextmenu",{target:e.get(0)});return this.element.trigger(t)},close:function(){return this._closeMenu.call(this)}}),e.extend(e.ui.contextmenu,{createMenuMarkup:function(t,n){var o,i,s,u,r;for(null==n&&(n=e("<ul class='ui-helper-hidden'>").appendTo("body")),o=0;t.length>o;o++)i=t[o],u=e("<li>").appendTo(n),i.title.match(/^---/)?u.text(i.title):(r=e("<a>",{text:""+i.title,href:"#"+(i.cmd||"")}).appendTo(u),i.uiIcon&&r.append(e("<span class='ui-icon'>").addClass(i.uiIcon)),i.disabled&&r.addClass("ui-state-disabled")),e.isArray(i.children)&&(s=e("<ul>").appendTo(u),e.ui.contextmenu.createMenuMarkup(i.children,s));return n}})})(jQuery);